#!/bin/bash

# Git post-commit hook for changelog sync

# æ£€æŸ¥æ˜¯å¦æœ‰ changelog ç›¸å…³æ–‡ä»¶å˜æ›´
changed_files=$(git diff-tree --no-commit-id --name-only -r HEAD)

if echo "$changed_files" | grep -q "CHANGELOG.md\|changelog.md"; then
    echo "ðŸ“ Changelog changes detected, triggering sync..."
    
    # å¼‚æ­¥æ‰§è¡ŒåŒæ­¥ï¼Œé¿å…é˜»å¡ž commit
    nohup node scripts/sync-to-gitbook.js > /tmp/gitbook-sync.log 2>&1 &
    
    echo "ðŸš€ Changelog sync started in background"
    echo "ðŸ“„ Log file: /tmp/gitbook-sync.log"
fi